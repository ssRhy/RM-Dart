# 代码编写指南

- [代码编写指南](#代码编写指南)
  - [简介](#简介)
  - [1](#1)
  - [2 各个模块的使用](#2-各个模块的使用)
    - [2.1 电机的使用](#21-电机的使用)
    - [2.2 IMU的使用](#22-imu的使用)
    - [2.3 信号发生器的使用](#23-信号发生器的使用)
    - [2.4 数据交换中心的使用](#24-数据交换中心的使用)
    - [2.5 上位机调试的使用](#25-上位机调试的使用)
    - [2.6 板间通信的使用](#26-板间通信的使用)

## 简介

## 1

## 2 各个模块的使用

### 2.1 电机的使用

相关文件: [motor.c/h](../application/robot_cmd/motor.c) , [CAN_communication.h](../application/robot_cmd/CAN_communication.h)

- **简介：**
- **创建电机对象：** [（motor.c/h）](../application/robot_cmd/motor.c) 使用`Motor_s`结构体定义电机对象

    ``` C
    #include "motor.h"
    Motor_s yaw_motor;
    ```

- **初始化：** [（motor.c/h）](../application/robot_cmd/motor.c) 使用 `MotorInit`函数完成电机对象的初始化

    ``` C
    #include "motor.h"
    MotorInit(&CHASSIS.joint_motor[3], 4, JOINT_CAN, DM_8009, J3_DIRECTION, 1, DM_MODE_MIT);
    ```

- **获取反馈数据：** [（CAN_receive.h）](../application/robot_cmd/CAN_receive.h)使用 `GetMotorMeasure`函数获取电机的状态和测量值。

    ``` C
    #include "CAN_receive.h"
    GetMotorMeasure(&CHASSIS.joint_motor[0]);
    ```

- **设置控制量：** 将电机对象的`set`属性中的对应控制量设置为需要发送的控制量
- **发送控制量：** 对不同的电机使用不同的发送函数。如：

    ``` C
    #include "CAN_communication.h"
    CanCmdDjiMotor(1, DJI_3508_MODE_CURRENT_1, 100, 100, 100, 100);
    DmMitCtrlTorque(&CHASSIS.joint_motor[0]);
    ...
    ```

    具体需要使用什么电机的函数请至 [CAN_communication.h](../application/robot_cmd/CAN_communication.h) 中查阅

### 2.2 IMU的使用

- **简介：**
- **定义IMU对象：** 使用 `Imu_t` 结构体定义IMU对象

    ``` C
    #include "data_exchange.h"
    Imu_t * IMU;
    ```

- **获取数据指针：** 使用`Subscribe`函数订阅IMU数据指针

    ``` C
    #include "data_exchange.h"
    CHASSIS.imu = Subscribe("imu_data");
    ```

### 2.3 信号发生器的使用

- **简介：** 在[signal_generator.h](../components/support/signal_generator.h)中提供了以下信号发生函数：
  - `GenerateSinWave` 用于生成正弦信号
  - `GenerateStepWave` 用于生成阶跃信号
  - `GenerateRampWave` 用于生成斜坡波信号
  - `GeneratePulseWave` 用于生成脉冲波形信号
  - `GenerateSawtoothWave` 用于生成锯齿波形信号
- **生成信号：** 调用对应的信号发生器，填入参数即可

### 2.4 数据交换中心的使用

- **简介：** 为了方便各个模块之间交换数据，减小耦合程度，使用数据交换中心来进行数据交换。在[data_exchange.h](../application/assist/data_exchange.h)中提供了`Publish`和`Subscribe`函数用来发布和订阅数据。

### 2.5 上位机调试的使用

### 2.6 板间通信的使用
