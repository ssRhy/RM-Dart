# 更新日志&想法记录

## 2024-08-05

@Penguin

虽然发生的概率很低，但还是要考虑一下切换控制数据源的备用方案，监测遥控器和裁判系统的掉线情况，当遥控器掉线时切换至图传链路中的同步发送的键鼠数据。

数据源：

1. 遥控器数据
2. 图传键鼠数据
3. UART同步其他板的数据
4. CAN同步其他板的数据

> 可以考虑创建一个 Monitor Task 实现对整车外接设备状态的一个监测。

## 2024-08-03

@Penguin

发现原来的校准任务中只有陀螺仪校准，没有加速度计校准，后面要加上。

## 2024-08-01

@Penguin

思考了一下，在新框架之下，思维也要切换过来。需要提高模块本身的自由度，将参数配置放在配置文件中。

功能可以不用，但是必须要有。

## 2024-07-28

@Penguin

更新了全新的校准任务，更适合现在的车车。

## 2024-07-27

@Penguin

再思考了一下，还是沿用之前的设计，将校准单独组成一个任务。方便统一进行校准任务的调度，而且还要涉及到遥控器失能的操作。

要想办法把校准模式中的蜂鸣器部分移至到music部分，校准任务里只需激活music任务中的对应蜂鸣器叫声即可。

## 2024-07-26

@Penguin

突发奇想，当接收到数据的时候记录下时间，每次循环的时候计算当前时间与最新记录时间之间的间隔，大于阈值时便可判断为没有usb设备连接。

- +1：USB_Receive 每次读取操作都会将数据搬运到缓冲区中，即便没有接收到数据。这时可以根据上位机添加的时间戳来判断数据是否更新。
- +1：当 usb 离线状态接收到数据后不应该直接将离线标识符置为false，应该等待连续几次稳定的接收到数据后再将变化标识符。

### IDEA

1. 考虑将校准任务可以拆分开来，分散到各个模块的任务中。（但是又感觉单独的一个校准任务比较好管理校准数据，毕竟总要把数据从flash中读出来存放到某个变量中）
2. 上位机下发数据中的时间戳可以为基于上位机获得的时间戳，而非与下位机时间对齐。（后续如果有对时间戳进行更多的应用的化要重新考虑时间戳时间基点）

### NOTE

> 其实本文件创建的目的就是为了记录开发过程中的更新内容，不过第二天觉得在有 git graph 和大量提交信息的情况下没有必要单独写一个日志文件来记录。这导致了本文件自创建以后便一直没有被动过。今天在浏览交龙自瞄开源时发现他们的更新日志写的非常好、非常详细，清晰的看到思考过程和各种想法的记录。加上一般提交信息都比较简短，只能简要描述变化内容，不能很好的记录下思考和奇怪点子，于是乎我便打算继续在这个文件中记录更新日志了。

## 2024-07-25

@Penguin

确定了标签版本的命名方法：
x.y.z-release-beta

- x:重大版本更新时++（基本不会遇到吧，不出意外应该一直是1）
- y:新增模块内容时++
- z:小更新/修复bug++
- 如果是要创建发行版的标签，应该加上后缀<-release>，测试版本再接<-beta>

> 当版本号++后，其后面的小版本号都归零重新计数

尝试添加宏函数来进行每个函数中行为类似的发送间隔检查操作，因为今天又因为复制代码忘记改变量名出现奇怪BUG了。

## 2024-03-27 ~ 2024-07-25

未记载，过于久远了。

## 2024-03-27

@Penguin

在看到各组代码相互黑盒，不透明，复用性极差，以及战队电控成员质量参差不齐的情况下决定开始基于大家所熟悉的dji c板示例代码 `20.standard_robot` 开始开发本框架。

因为是基于 `20.standard_robot` ，所以名字也就叫做 `StandardRobot++` 啦
